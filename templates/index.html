<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ–ç‰‡å»èƒŒ + è½‰æª”å·¥å…·</title>
</head>
<body>
    <h1>åœ–ç‰‡å»èƒŒ + è½‰æª”ï¼ˆæ”¯æ´å¤šå¼µ + å³æ™‚é è¦½ï¼‰</h1>

    <form action="/" method="POST" enctype="multipart/form-data">
        <input type="file" name="files" id="fileInput" multiple required accept="image/*">  <!-- æ”¯æ´å¤šæª”æ¡ˆä¸Šå‚³ -->
        
        <div id="preview"></div> <!-- é è¦½å€å¡Š -->

        <label>é¸æ“‡è¼¸å‡ºæ ¼å¼ï¼š</label>
        <select name="format">
            <option value="png">PNG</option>
            <option value="jpg">JPG</option>
            <option value="webp">WEBP</option>
        </select>

        <label>é¸æ“‡èƒŒæ™¯é¡è‰²ï¼š</label>
        <select name="bg_color" id="bg_color">
            <option value="transparent">é€æ˜</option>
            <option value="white">ç™½è‰²</option>
            <option value="black">é»‘è‰²</option>
        </select>
        
        <label for="custom_color">è‡ªè¨‚é¡è‰²ï¼š</label>
        <input type="color" id="custom_color" name="custom_color">

        <button type="submit">ä¸Šå‚³ä¸¦è™•ç†</button>
    </form>

    <script>
        document.getElementById("fileInput").addEventListener("change", function(event) {
            const previewDiv = document.getElementById("preview");
            previewDiv.innerHTML = ""; // æ¸…ç©ºå…ˆå‰é è¦½

            const files = event.target.files;
            for (const file of files) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement("img");
                    img.src = e.target.result;
                    img.width = 200;
                    img.style.margin = "10px";
                    previewDiv.appendChild(img);
                };
                reader.readAsDataURL(file);
            }
        });
    </script>

    {% if filenames %}
        <h2>è™•ç†å¾Œçš„åœ–ç‰‡ï¼š</h2>
        <ul>
            {% for filename in filenames %}
                <li>
                    <img src="{{ url_for('static', filename='processed/' + filename) }}" width="200">
                    <br>
                    <a href="{{ url_for('download_file', filename=filename) }}" download>ä¸‹è¼‰åœ–ç‰‡</a>
                </li>
            {% endfor %}
        </ul>

        {% if zip_filename %}
            <h2>æ‰¹é‡ä¸‹è¼‰</h2>
            <a href="{{ url_for('download_file', filename=zip_filename) }}" download>ğŸ“¦ ä¸‹è¼‰å…¨éƒ¨åœ–ç‰‡ï¼ˆZIPï¼‰</a>
        {% endif %}
    {% endif %}
</body>
</html>
